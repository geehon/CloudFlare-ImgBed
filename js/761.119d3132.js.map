{"version":3,"file":"js/761.119d3132.js","mappings":"8LACO,SAASA,EAAOC,EAAMC,EAAQC,EAAQC,EAAQC,EAAOC,GAC1D,MAAMC,EAAuB,IAC7B,OAAO,WAAc,QAAaA,EAAsB,CACtDC,MAAO,QACPC,OAAQJ,EAAMK,YACd,cAAe,KACf,iBAAkB,kBAClB,YAAY,EACZC,QAASN,EAAMO,UACfC,SAAUP,EAASQ,aAClB,KAAM,EAAG,CAAC,SAAU,UAAW,YACpC,C,6BCRA,GACE,IAAAC,GACE,MAAO,CACLH,WAAW,EACXF,YAAa,CAAC,CACZM,IAAK,WACLC,MAAO,MACPC,YAAa,SACbC,KAAM,OACNC,KAAM,QACL,CACDJ,IAAK,WACLC,MAAO,KACPC,YAAa,QACbC,KAAM,WACNE,cAAc,EACdD,KAAM,SAGZ,EACAE,WAAY,CACVC,UAAS,KAEXC,QAAS,CACP,iBAAMV,CAAYW,GAChB,MAAM,SACJC,EAAQ,SACRC,GACEF,EACEG,EAAcC,KAAK,GAAGH,KAAYC,KAExCG,KAAKlB,WAAY,EAGjB,MAAMmB,EAAkB,IAAIC,QAAQC,GAAWC,WAAWD,EAAS,MAE7DE,EAAeC,EAAA,EAAMC,IAAI,oBAAqB,CAClDC,QAAS,CACP,cAAiB,SAASV,KAE5BW,iBAAiB,IAChBC,KAAKC,IAAY,CAClBA,cACEC,MAAMC,IAAS,CACjBA,WAEF,IACE,MAAOC,SAAgBZ,QAAQa,IAAI,CAACV,EAAcJ,IAClD,GAAIa,EAAOH,UAAuC,MAA3BG,EAAOH,SAASK,OAErChB,KAAKiB,OAAOC,OAAO,iBAAkBpB,GACrCE,KAAKmB,QAAQC,KAAK,kBACb,CACL,MAAMP,EAAQC,EAAOD,OAAS,IAAIQ,MAAM,iBACxCrB,KAAKlB,WAAY,EACb+B,EAAMF,UAAsC,MAA1BE,EAAMF,SAASK,OACnChB,KAAKsB,SAAST,MAAM,YAEpBb,KAAKsB,SAAST,MAAM,QAExB,CACF,CAAE,MAAOA,GAEPb,KAAKlB,WAAY,EACjBkB,KAAKsB,SAAST,MAAM,OACtB,CACF,I,UCjEJ,MAAMU,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASrD,KAEpE,O,0JCNA,MAAMsD,EAAa,CACjBC,MAAO,mBAEHC,EAAa,CACjBD,MAAO,iBAEHE,EAAa,CACjBzC,IAAK,EACLuC,MAAO,gBAEHG,EAAa,CACjB1C,IAAK,GAEA,SAAShB,EAAOC,EAAMC,EAAQC,EAAQC,EAAQC,EAAOC,GAC1D,MAAMqD,EAAqB,KACrBC,EAAsB,KACtBC,EAAuB,KAC7B,OAAO,WAAc,QAAoB,MAAO,CAC9CN,OAAO,QAAgB,CAAC,QAAS,CAC/B,aAAclD,EAAMyD,cAErB,EAAC,QAAoB,MAAOR,EAAY,GAAE,SAAW,IAAO,QAAoB,KAAW,MAAM,QAAYnD,EAAOM,OAAQ,CAACsD,EAAOC,MAC9H,WAAc,QAAoB,MAAO,CAC9ChD,IAAK+C,EAAM/C,IACXuC,MAAO,mBACN,EAAC,QAAoB,QAAS,CAC/BA,MAAO,aACPU,SAAS,EACTC,IAAK,aAAaF,IAClBG,OAAO,QAAgB,CACrB,oBAAqB9D,EAAM+D,qBAAqBJ,GAAS,SAE1D,QAAiBD,EAAM9C,OAAQ,IAAI,QAAoB,MAAOuC,EAAY,EAAC,QAAaI,EAAqB,CAC9GS,WAAYhE,EAAMoB,SAASsC,EAAM/C,KACjC,sBAAuBsD,GAAUjE,EAAMoB,SAASsC,EAAM/C,KAAOsD,EAC7DpD,YAAa6C,EAAM7C,YACnBC,KAAM4C,EAAM5C,MAAQ,OACpB,gBAAiB4C,EAAM1C,aACvBkC,MAAO,iBACPgB,SAAS,QAAUjE,EAASkE,aAAc,CAAC,QAAS,WACpDC,QAASnE,EAASoE,iBAClBC,OAAQrE,EAASsE,kBAChB,QAAa,CACdC,EAAG,GACF,CAACd,EAAM3C,KAAO,CACf0D,KAAM,SACNC,IAAI,QAAS,IAAM,EAAC,QAAapB,EAAoB,CACnDJ,MAAO,kBACN,CACDyB,SAAS,QAAS,IAAM,GAAE,WAAc,SAAa,QAAyBjB,EAAM3C,UACpFyD,EAAG,GACF,QACH7D,IAAK,UACHiE,IAAa,KAAM,CAAC,aAAc,sBAAuB,cAAe,OAAQ,gBAAiB,UAAW,UAAW,iBACzH,OAAO,QAAapB,EAAsB,CAC5CN,OAAO,QAAgB,CAAC,SAAU,CAChC,aAAcpD,EAAOQ,WAEvBQ,KAAM,UACN+D,QAAS5E,EAASkE,aAClBW,SAAUhF,EAAOQ,SAChB,CACDqE,SAAS,QAAS,IAAM,CAAC7E,EAAOQ,UAAW,WAAc,QAAoB,MAAO8C,MAAgB,WAAc,QAAoB,OAAQC,GAAY,QAAiBvD,EAAOiF,YAAa,MAC/LP,EAAG,GACF,EAAG,CAAC,QAAS,UAAW,gBAAiB,EAC9C,C,sEC3DA,GACEC,KAAM,YACNO,OAAQ,CAACC,EAAA,GACTC,MAAO,CAEL/E,MAAO,CACLW,KAAMqE,OACNC,UAAU,GAGZhF,OAAQ,CACNU,KAAMuE,MACND,UAAU,GAIZL,WAAY,CACVjE,KAAMqE,OACNR,QAAS,MAGXW,cAAe,CACbxE,KAAMqE,OACNC,UAAU,GAGZG,QAAS,CACPzE,KAAM0E,QACNb,SAAS,GAGXrE,QAAS,CACPQ,KAAM0E,QACNb,SAAS,IAGb,IAAAjE,GACE,MAAO,CACLU,SAAU,CAAC,EACX2C,qBAAsB,GACtBN,WAAW,EAEf,EACAgC,SAAU,KACL,QAAW,CAAC,gBAEjBC,MAAO,CACLtF,OAAQ,CACN,OAAAuF,GACElE,KAAKmE,UAAU,KACbnE,KAAKoE,wBAET,EACAC,MAAM,IAGV7E,WAAY,CACV8E,OAAM,IACNC,WAAU,IACVC,KAAI,KAEN,OAAAC,GAEEzE,KAAK0E,eAEL1E,KAAK2E,qBAAqB3E,KAAK6D,cAAe,UAAW7D,KAAK8D,SAAS,GAEvE9D,KAAKmE,UAAU,KACbnE,KAAKoE,wBAET,EACA1E,QAAS,CACP,YAAAgF,GAEE,MAAME,EAAc,CAAC,EACrB5E,KAAKrB,OAAOkG,QAAQ5C,IAClB2C,EAAY3C,EAAM/C,KAAO,KAE3Bc,KAAKL,SAAWiF,EAEhB5E,KAAKsC,qBAAuB,IAAIsB,MAAM5D,KAAKrB,OAAOmG,QAAQC,KAAK,EACjE,EACA,oBAAAX,GAEEpE,KAAKmE,UAAU,KACbnE,KAAKrB,OAAOkG,QAAQ,CAAC5C,EAAOC,KAC1B,MAAM8C,EAAWhF,KAAKiF,MAAM,aAAa/C,KACzC,GAAI8C,GAAYA,EAAS,GAAI,CAE3B,MAAME,EAASC,SAASC,cAAc,UAChCC,EAAUH,EAAOI,WAAW,MAG5BC,EAAeP,EAAS,GACxBQ,EAAgBC,OAAOC,iBAAiBH,GAG9CF,EAAQM,KAAO,GAAGH,EAAcI,cAAcJ,EAAcK,YAAYL,EAAcM,aAGtF,MAAMC,EAAYV,EAAQW,YAAY/D,EAAM9C,OAAO8G,MAGnDjG,KAAKsC,qBAAqBJ,GAASgE,KAAKC,KAAKJ,GAAa,CAC5D,KAGN,EACA,YAAArD,GACM1C,KAAKnB,SAETmB,KAAKoG,MAAM,SAAU,IAChBpG,KAAKL,UAEZ,EACA,gBAAAiD,CAAiByD,GACfrG,KAAKgC,WAAY,EACjB,MAAMsE,EAAYD,EAAME,OAAOC,QAAQ,oBACvC,GAAIF,EAAW,CACb,MAAMG,EAAUH,EAAUI,cAAc,kBACpCD,GACFA,EAAQE,UAAUC,IAAI,UAE1B,CACF,EACA,eAAA9D,CAAgBuD,GACdrG,KAAKgC,WAAY,EACjB,MAAMsE,EAAYD,EAAME,OAAOC,QAAQ,oBACvC,GAAIF,EAAW,CACb,MAAMG,EAAUH,EAAUI,cAAc,kBACpCD,GACFA,EAAQE,UAAUE,OAAO,UAE7B,CACF,I,UCtIJ,MAAMtF,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASrD,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://sanyue_imghub/./src/views/AdminLogin.vue?1f0e","webpack://sanyue_imghub/./src/views/AdminLogin.vue","webpack://sanyue_imghub/./src/views/AdminLogin.vue?06e1","webpack://sanyue_imghub/./src/components/BaseLogin.vue?05c6","webpack://sanyue_imghub/./src/components/BaseLogin.vue","webpack://sanyue_imghub/./src/components/BaseLogin.vue?0ac4"],"sourcesContent":["import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_BaseLogin = _resolveComponent(\"BaseLogin\");\n  return _openBlock(), _createBlock(_component_BaseLogin, {\n    title: \"管理端登录\",\n    fields: $data.loginFields,\n    \"submit-text\": \"登录\",\n    \"background-key\": \"adminLoginBkImg\",\n    \"is-admin\": true,\n    loading: $data.isLoading,\n    onSubmit: $options.handleLogin\n  }, null, 8, [\"fields\", \"loading\", \"onSubmit\"]);\n}","import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport BaseLogin from '@/components/BaseLogin.vue';\nimport axios from '@/utils/axios';\nexport default {\n  data() {\n    return {\n      isLoading: false,\n      loginFields: [{\n        key: 'username',\n        label: '用户名',\n        placeholder: '请输入用户名',\n        type: 'text',\n        icon: 'User'\n      }, {\n        key: 'password',\n        label: '密码',\n        placeholder: '请输入密码',\n        type: 'password',\n        showPassword: true,\n        icon: 'Lock'\n      }]\n    };\n  },\n  components: {\n    BaseLogin\n  },\n  methods: {\n    async handleLogin(formData) {\n      const {\n        username,\n        password\n      } = formData;\n      const credentials = btoa(`${username}:${password}`); // Base64 编码\n\n      this.isLoading = true;\n\n      // Min delay promise\n      const minDelayPromise = new Promise(resolve => setTimeout(resolve, 1000));\n      // Request promise handling its own error to return it\n      const loginPromise = axios.get('/api/manage/check', {\n        headers: {\n          'Authorization': `Basic ${credentials}`\n        },\n        withCredentials: true\n      }).then(response => ({\n        response\n      })).catch(error => ({\n        error\n      }));\n      try {\n        const [result] = await Promise.all([loginPromise, minDelayPromise]);\n        if (result.response && result.response.status === 200) {\n          // 认证成功，存储认证信息，跳转到管理页面\n          this.$store.commit('setCredentials', credentials);\n          this.$router.push('/dashboard');\n        } else {\n          const error = result.error || new Error('Unknown error');\n          this.isLoading = false;\n          if (error.response && error.response.status === 401) {\n            this.$message.error('用户名或密码错误');\n          } else {\n            this.$message.error('服务器错误');\n          }\n        }\n      } catch (error) {\n        // Should not reach here due to inner catch, but just in case\n        this.isLoading = false;\n        this.$message.error('系统错误');\n      }\n    }\n  }\n};","/* unplugin-vue-components disabled */import { render } from \"./AdminLogin.vue?vue&type=template&id=bc2c2164\"\nimport script from \"./AdminLogin.vue?vue&type=script&lang=js\"\nexport * from \"./AdminLogin.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, resolveDynamicComponent as _resolveDynamicComponent, createBlock as _createBlock, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, withKeys as _withKeys, createSlots as _createSlots, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login-container\"\n};\nconst _hoisted_2 = {\n  class: \"input-wrapper\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"loading-ring\"\n};\nconst _hoisted_4 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  return _openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"login\", {\n      'is-focused': $data.isFocused\n    }])\n  }, [_createElementVNode(\"div\", _hoisted_1, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.fields, (field, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: field.key,\n      class: \"input-container\"\n    }, [_createElementVNode(\"label\", {\n      class: \"input-name\",\n      ref_for: true,\n      ref: `inputLabel${index}`,\n      style: _normalizeStyle({\n        '--underline-width': $data.labelUnderlineWidths[index] + 'px'\n      })\n    }, _toDisplayString(field.label), 5), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_input, {\n      modelValue: $data.formData[field.key],\n      \"onUpdate:modelValue\": $event => $data.formData[field.key] = $event,\n      placeholder: field.placeholder,\n      type: field.type || 'text',\n      \"show-password\": field.showPassword,\n      class: \"password-input\",\n      onKeyup: _withKeys($options.handleSubmit, [\"enter\", \"native\"]),\n      onFocus: $options.handleInputFocus,\n      onBlur: $options.handleInputBlur\n    }, _createSlots({\n      _: 2\n    }, [field.icon ? {\n      name: \"prefix\",\n      fn: _withCtx(() => [_createVNode(_component_el_icon, {\n        class: \"el-input__icon\"\n      }, {\n        default: _withCtx(() => [(_openBlock(), _createBlock(_resolveDynamicComponent(field.icon)))]),\n        _: 2\n      }, 1024)]),\n      key: \"0\"\n    } : undefined]), 1032, [\"modelValue\", \"onUpdate:modelValue\", \"placeholder\", \"type\", \"show-password\", \"onKeyup\", \"onFocus\", \"onBlur\"])])]);\n  }), 128)), _createVNode(_component_el_button, {\n    class: _normalizeClass([\"submit\", {\n      'is-loading': $props.loading\n    }]),\n    type: \"primary\",\n    onClick: $options.handleSubmit,\n    disabled: $props.loading\n  }, {\n    default: _withCtx(() => [$props.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3)) : (_openBlock(), _createElementBlock(\"span\", _hoisted_4, _toDisplayString($props.submitText), 1))]),\n    _: 1\n  }, 8, [\"class\", \"onClick\", \"disabled\"])])], 2);\n}","import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport Footer from '@/components/Footer.vue';\nimport ToggleDark from '@/components/ToggleDark.vue';\nimport Logo from '@/components/Logo.vue';\nimport { mapGetters } from 'vuex';\nimport backgroundManager from '@/mixins/backgroundManager';\nexport default {\n  name: 'BaseLogin',\n  mixins: [backgroundManager],\n  props: {\n    // 页面标题\n    title: {\n      type: String,\n      required: true\n    },\n    // 输入字段配置\n    fields: {\n      type: Array,\n      required: true\n      // fields 格式: [{ key: 'username', label: '用户名', placeholder: '请输入用户名', type: 'text', showPassword: false }]\n    },\n    // 提交按钮文本\n    submitText: {\n      type: String,\n      default: '登录'\n    },\n    // 背景图配置键名\n    backgroundKey: {\n      type: String,\n      required: true\n    },\n    // 是否为管理端登录（影响背景样式）\n    isAdmin: {\n      type: Boolean,\n      default: false\n    },\n    // 是否正在加载\n    loading: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      formData: {},\n      labelUnderlineWidths: [],\n      isFocused: false\n    };\n  },\n  computed: {\n    ...mapGetters(['userConfig'])\n  },\n  watch: {\n    fields: {\n      handler() {\n        this.$nextTick(() => {\n          this.calculateLabelWidths();\n        });\n      },\n      deep: true\n    }\n  },\n  components: {\n    Footer,\n    ToggleDark,\n    Logo\n  },\n  mounted() {\n    // 初始化表单数据\n    this.initFormData();\n    // 初始化背景图\n    this.initializeBackground(this.backgroundKey, '.login', !this.isAdmin, true);\n    // 在下一个tick计算标签宽度，确保DOM已经渲染\n    this.$nextTick(() => {\n      this.calculateLabelWidths();\n    });\n  },\n  methods: {\n    initFormData() {\n      // 根据字段配置初始化表单数据\n      const newFormData = {};\n      this.fields.forEach(field => {\n        newFormData[field.key] = '';\n      });\n      this.formData = newFormData;\n      // 初始化下划线宽度数组\n      this.labelUnderlineWidths = new Array(this.fields.length).fill(0);\n    },\n    calculateLabelWidths() {\n      // 计算每个标签的文字宽度\n      this.$nextTick(() => {\n        this.fields.forEach((field, index) => {\n          const labelRef = this.$refs[`inputLabel${index}`];\n          if (labelRef && labelRef[0]) {\n            // 创建一个临时的canvas来测量文字宽度\n            const canvas = document.createElement('canvas');\n            const context = canvas.getContext('2d');\n\n            // 获取标签的计算样式\n            const labelElement = labelRef[0];\n            const computedStyle = window.getComputedStyle(labelElement);\n\n            // 设置font样式以匹配标签\n            context.font = `${computedStyle.fontWeight} ${computedStyle.fontSize} ${computedStyle.fontFamily}`;\n\n            // 测量文字宽度\n            const textWidth = context.measureText(field.label).width;\n\n            // 添加一些额外的边距，确保下划线覆盖整个文字\n            this.labelUnderlineWidths[index] = Math.ceil(textWidth) + 3;\n          }\n        });\n      });\n    },\n    handleSubmit() {\n      if (this.loading) return;\n      // 触发父组件的提交事件，传递表单数据\n      this.$emit('submit', {\n        ...this.formData\n      });\n    },\n    handleInputFocus(event) {\n      this.isFocused = true;\n      const container = event.target.closest('.input-container');\n      if (container) {\n        const wrapper = container.querySelector('.input-wrapper');\n        if (wrapper) {\n          wrapper.classList.add('focused');\n        }\n      }\n    },\n    handleInputBlur(event) {\n      this.isFocused = false;\n      const container = event.target.closest('.input-container');\n      if (container) {\n        const wrapper = container.querySelector('.input-wrapper');\n        if (wrapper) {\n          wrapper.classList.remove('focused');\n        }\n      }\n    }\n  }\n};","/* unplugin-vue-components disabled */import { render } from \"./BaseLogin.vue?vue&type=template&id=53d87903&scoped=true\"\nimport script from \"./BaseLogin.vue?vue&type=script&lang=js\"\nexport * from \"./BaseLogin.vue?vue&type=script&lang=js\"\n\nimport \"./BaseLogin.vue?vue&type=style&index=0&id=53d87903&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-53d87903\"]])\n\nexport default __exports__"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_component_BaseLogin","title","fields","loginFields","loading","isLoading","onSubmit","handleLogin","data","key","label","placeholder","type","icon","showPassword","components","BaseLogin","methods","formData","username","password","credentials","btoa","this","minDelayPromise","Promise","resolve","setTimeout","loginPromise","axios","get","headers","withCredentials","then","response","catch","error","result","all","status","$store","commit","$router","push","Error","$message","__exports__","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_component_el_icon","_component_el_input","_component_el_button","isFocused","field","index","ref_for","ref","style","labelUnderlineWidths","modelValue","$event","onKeyup","handleSubmit","onFocus","handleInputFocus","onBlur","handleInputBlur","_","name","fn","default","undefined","onClick","disabled","submitText","mixins","backgroundManager","props","String","required","Array","backgroundKey","isAdmin","Boolean","computed","watch","handler","$nextTick","calculateLabelWidths","deep","Footer","ToggleDark","Logo","mounted","initFormData","initializeBackground","newFormData","forEach","length","fill","labelRef","$refs","canvas","document","createElement","context","getContext","labelElement","computedStyle","window","getComputedStyle","font","fontWeight","fontSize","fontFamily","textWidth","measureText","width","Math","ceil","$emit","event","container","target","closest","wrapper","querySelector","classList","add","remove"],"ignoreList":[],"sourceRoot":""}